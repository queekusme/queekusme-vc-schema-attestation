



TODO Workgroup                                              A.J. Kennedy
Internet-Draft                                          20 November 2025
Intended status: Standards Track                                        
Expires: 24 May 2026


                Verifiable Credential Schema Attestation
              draft-queekusme-vc-schema-attestation-latest

Abstract

   This specification defines request and response formats for Attesting
   Issuers and Verifiers for individual Verifiable Credential Schema via
   a Schema Attestation Document

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Source for this draft and an issue tracker can be found at
   https://github.com/queekusme/queekusme-vc-schema-attestation.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 24 May 2026.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Trust in the Issuer-Holder-Verifier Model
     1.2.  Requirements Notation and Conventions
     1.3.  Terms and Definitions
     1.4.  Verifiable Credential Schema documents
   2.  Verifiable Credential Schema Attestation Document
     2.1.  Schema Attestation Document
       2.1.1.  Schema Attestation Document Claims
       2.1.2.  Schema Document Attestation Well-known Endpoint
       2.1.3.  Request Parameters
     2.2.  Schema Attestation Document Response
       2.2.1.  Example
       2.2.2.  JOSE Header
     2.3.  Verifying Schema Attestation Documents
       2.3.1.  Verifying Issuers in authorized_issuers
       2.3.2.  Verifying verifiers in authorized_verifiers
     2.4.  Schema Extension
   3.  Security Considerations
     3.1.  Issuer/Verifier Request for Information Discovery
     3.2.  Schema Extension as a method for attaining a trusted
           status.
   4.  References
     4.1.  Normative References
     4.2.  Informative References
   Appendix A.  IANA Considerations
     A.1.  JSON Web Token Claims Registration
     A.2.  Well-Known URI Registry
   Appendix B.  Acknowledgements
   Appendix C.  Document History
   Author's Address

1.  Introduction

1.1.  Trust in the Issuer-Holder-Verifier Model

   Implementations of the Issuer-Holder-Verifier model have created
   solutions for the problem of trust in the issuance of and attestation
   of verifiers for verifiable credentials.  Wallets and verifiers MAY
   subscribe to specific trust anchors to verify:

   *  A Verifiable Credential has been issued by an authorised issuer
   *  A verifier is authorised to receive a Verifiable Credential

   Whilst certain wallets can subscribe to a closed system for trust,
   others MAY wish to accept credentials from any issuer allowing the
   holder of the aforementioned Credential to present and have verified
   any Verifiable Credential.

   The Wallet would need to determine the correct trust anchors to
   subscribe to in order to ascertain the correct level of trust in
   Credential issuers and verifiers

1.2.  Requirements Notation and Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in RFC
   2119 [RFC2119].

1.3.  Terms and Definitions

   This specification uses the terms "Holder", "Issuer", "Verifier",
   "Disclosure", "Selectively Disclosable JWT (SD-JWT)", "Key Binding",
   "Key Binding JWT (KB-JWT)", "Selectively Disclosable JWT with Key
   Binding (SD-JWT+KB)" defined by
   [I-D.ietf-oauth-selective-disclosure-jwt].

   Verifiable Credential (VC):  An assertion with claims about a Subject
      that is cryptographically secured by an Issuer (usually by a
      digital signature).

1.4.  Verifiable Credential Schema documents

   Verifiable Credential Schema are documents which define the structure
   of verifiable credentials in a manner which allows verifiers and
   other external software and tooling to determine if a Credential
   conforms to the schema design.

   The Verifiable Credential formats which utilize schema documents are:

   *  W3C Verifiable Credential Data Model (VCDM) 2.0 [W3C.VCDM] which
      uses JSON-LD as its structure definition
   *  SD-JWT-based Verifiable Credentials [I-D.ietf-oauth-sd-jwt-vc]
      which uses its own defined vct structure definition.

   MDoc Credential formats are outside of the scope of this document

   Both [W3C.VCDM] and [I-D.ietf-oauth-sd-jwt-vc] permit schema document
   definition via URL request.

2.  Verifiable Credential Schema Attestation Document

2.1.  Schema Attestation Document

   The Schema Attestation Document is a Selective Disclosure JWT
   [I-D.ietf-oauth-selective-disclosure-jwt] which attests to the
   validity to issue or verify a Verifiable Credential of a specific
   Schema.

2.1.1.  Schema Attestation Document Claims

   The specification defines the following JWT claims:

   *  iss: REQUIRED.  The issuer of the document, MUST be a [W3C.DID]
      identifier
   *  sub: REQUIRED.  The string schema document URL.  This being the
      [W3C.VCDM] credentialSchema.id URL or the
      [I-D.ietf-oauth-sd-jwt-vc] vct URL.
   *  sub#integrity: REQUIRED.  A string containing the [W3C.SRI]
      integrity of the Schema Document this Attestation points to.
   *  authorized_issuers: OPTIONAL.  An array of strings containing the
      issuers which are authorised to issue credentials matching the
      Schema. authorized_issuers MAY be an empty array.
   *  authorized_verifiers: OPTIONAL.  An array of strings containing
      the verifiers which are authorised to issue credentials matching
      the Schema. authorized_issuers MAY be an empty array.
   *  nonce: REQUIRED if included in POST Request Parameters, otherwise
      OPTIONAL.  The nonce provided by the requester, ensures signature
      freshness

   JWT claims iat, nbf and exp SHOULD be used to establish timeframes
   for the acceptance and disposal of expired Attestation JWTs

2.1.1.1.  Selective Disclosure

   The Selective Disclosure JWT Response SHOULD use Decoy Digests to
   disguise the actual number of authorized issuers and verifiers.

   The iat, nbf and exp claims MUST NOT be Selectively Disclosable in
   SD-JWT responses where provided.

   The iss, sub, sub#integrity and nonce claims MUST NOT be Selectively
   Disclosable.

   The authorized_issuers and authorized_verifiers claims SHOULD be
   Selectively Disclosable, all array values of authorized_issuers and
   authorized_verifiers SHOULD be Selectively Disclosable.

2.1.1.2.  Examples

   The following is a non-normative example of the raw attestation data
   of an unsecured payload of a Schema Attestation Document:

   {
     "sub": "http://example.com/example-credential.json",
     "sub#integrity": "TODO: Get a hash value for here",
     "authorized_issuers": [
       "http://example.com/issuer"
     ],
     "authorized_verifiers": [
       "http://example.com/verifier"
     ]
   }

   The following is a non-normative example of how the unsecured payload
   of the raw attestation data above can be presented as an SD-JWT with
   authorized_issuers and authorized_verifiers claims selectively
   disclosable:

   {
     "_sd": [
       "dTsZySjJ-1zFeKSyizV-XRrUPcBLMFOvS_kfnJ7ar0U",
       "nNvDXJYbvNxPYwKKJ1L7ARui_Na2pjgrYCisHYdmIjk"
     ],
     "iss": "https://example.com/issuer",
     "iat": 1683000000,
     "exp": 1883000000,
     "sub": "http://example.com/example-credential.json",
     "sub#integrity": "TODO: Get a hash value for here",
     "_sd_alg": "sha-256"
   }

   The following are the Disclosures belonging to the SD-JWT payload
   above:

   *Array Entry*:

   *  SHA-256 Hash: WzmUkWEkWx9XGOxf1HX8TiIgICjQzM6rEpGIrGS6bUY
   *  Disclosure:
      WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgImh0dHA6Ly9leGFtcGxlLmNv
      bS9pc3N1ZXIiXQ
   *  Contents: ["2GLC42sKQveCfGfryNRN9w", "http://example.com/issuer"]

   *Claim authorized_issuers*:

   *  SHA-256 Hash: nNvDXJYbvNxPYwKKJ1L7ARui_Na2pjgrYCisHYdmIjk
   *  Disclosure:
      WyJlbHVWNU9nM2dTTklJOEVZbnN4QV9BIiwgImF1dGhvcml6ZWRfaXNzdWVy
      cyIsIFt7Ii4uLiI6ICJXem1Va1dFa1d4OVhHT3hmMUhYOFRpSWdJQ2pRek02
      ckVwR0lyR1M2YlVZIn1dXQ
   *  Contents: ["eluV5Og3gSNII8EYnsxA_A", "authorized_issuers",
      [{"...":
      "WzmUkWEkWx9XGOxf1HX8TiIgICjQzM6rEpGIrGS6bUY"}]]

   *Array Entry*:

   *  SHA-256 Hash: cDj-sHSautcsQkWGSUOc5aiwQCbbyI6RO8flo1bWx6Q
   *  Disclosure:
      WyI2SWo3dE0tYTVpVlBHYm9TNXRtdlZBIiwgImh0dHA6Ly9leGFtcGxlLmNv
      bS92ZXJpZmllciJd
   *  Contents: ["6Ij7tM-a5iVPGboS5tmvVA", "http://example.com/
      verifier"]

   *Claim authorized_verifiers*:

   *  SHA-256 Hash: dTsZySjJ-1zFeKSyizV-XRrUPcBLMFOvS_kfnJ7ar0U
   *  Disclosure:
      WyJlSThaV205UW5LUHBOUGVOZW5IZGhRIiwgImF1dGhvcml6ZWRfdmVyaWZp
      ZXJzIiwgW3siLi4uIjogImNEai1zSFNhdXRjc1FrV0dTVU9jNWFpd1FDYmJ5
      STZSTzhmbG8xYld4NlEifV1d
   *  Contents: ["eI8ZWm9QnKPpNPeNenHdhQ", "authorized_verifiers",
      [{"...":
      "cDj-sHSautcsQkWGSUOc5aiwQCbbyI6RO8flo1bWx6Q"}]]

2.1.2.  Schema Document Attestation Well-known Endpoint

   Schema designers MAY make a Schema Attestation Document available at
   the location formed by inserting the well known string /.well-known/
   schema-attestation between the host component and the path component
   of the Schema URL.

   If a Schema Attestation Document is not made available at the well-
   known address, trust SHOULD defer back to other methods for
   determining trust.

   The following is a non-normative example of an HTTP request for the
   Schema Attestation Document when the Schema Document url is
   http://example.com/example-credential.json

   GET /.well-known/schema-attestation/example-credential.json HTTP/1.1
   Host: example.com

2.1.3.  Request Parameters

   The following parameters are defined to be included in the request to
   the Request URI Endpoint:

   *  issuer: OPTIONAL.  The Issuer to receive attestation information
      for if present in the Attestation Document
   *  verifier: OPTIONAL.  The Verifier to receive attestation
      information for if present in the Attestation Document
   *  nonce: REQUIRED.  A nonce ensuring the freshness of the signature
      in JWT responses

   The following is a non-normative example of an HTTP request for the
   Schema Attestation Document requesting attestation information for an
   issuer http://example.com/issuer

   POST /.well-known/schema-attestation/example-credential.json HTTP/1.1
   Host: example.com
   Content-Type: application/x-www-form-urlencoded

   issuer=http%3A%2F%2Fexample.com%2Fissuer

2.2.  Schema Attestation Document Response

   A successful response MUST use the 200 OK HTTP.  The Content-Type
   header MUST be application/sd-jwt.

   The document MUST return any issuer or verifier Disclosure matching
   the issuer or verifier provided in any Request Parameters.

2.2.1.  Example

   The following is a non-normative example of a Schema Attestation
   Document Response including Disclosures for attesting issuer
   http://example.com/issuer provided via request parameters"

   eyJhbGciOiAiRVMyNTYiLCAidHlwIjogInNjaGVtYS1hdHRlc3RhdGlvbitzZC1qd3Qi
   LCAia2lkIjogImRvYy1zaWduZXItMDUtMjUtMjAyMiJ9.eyJfc2QiOiBbImRUc1p5U2p
   KLTF6RmVLU3lpelYtWFJyVVBjQkxNRk92U19rZm5KN2FyMFUiLCAibk52RFhKWWJ2Tnh
   QWXdLS0oxTDdBUnVpX05hMnBqZ3JZQ2lzSFlkbUlqayJdLCAiaXNzIjogImh0dHBzOi8
   vZXhhbXBsZS5jb20vaXNzdWVyIiwgImlhdCI6IDE2ODMwMDAwMDAsICJleHAiOiAxODg
   zMDAwMDAwLCAic3ViIjogImh0dHA6Ly9leGFtcGxlLmNvbS9leGFtcGxlLWNyZWRlbnR
   pYWwuanNvbiIsICJzdWIjaW50ZWdyaXR5IjogIlRPRE86IEdldCBhIGhhc2ggdmFsdWU
   gZm9yIGhlcmUiLCAiX3NkX2FsZyI6ICJzaGEtMjU2In0.FwW81vNNE-R-YUkZu3A1Jj0
   debXAB-ao984MxXx7hxHek8VddExz7UFiwDeCq6J6g49BAsBzXpBpejGxJow_pg~WyJl
   bHVWNU9nM2dTTklJOEVZbnN4QV9BIiwgImF1dGhvcml6ZWRfaXNzdWVycyIsIFt7Ii4u
   LiI6ICJXem1Va1dFa1d4OVhHT3hmMUhYOFRpSWdJQ2pRek02ckVwR0lyR1M2YlVZIn1d
   XQ~WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgImh0dHA6Ly9leGFtcGxlLmNvbS9pc
   3N1ZXIiXQ~

   Below is a non-normative example of the verified SD-JWT claims the
   recipient of a Schema Attestation Document would receive when
   resolving Selective Disclosures in a Schema Attestation Document.

   {
     "iss": "https://example.com/issuer",
     "iat": 1683000000,
     "exp": 1883000000,
     "sub": "http://example.com/example-credential.json",
     "sub#integrity": "TODO: Get a hash value for here",
     "authorized_issuers": [
       "http://example.com/issuer"
     ]
   }

2.2.2.  JOSE Header

   The typ value in the JOSE Header MUST be schema-attestation+sd-jwt.

   The following is a non-normative example of a decoded SD-JWT header:

   {
     "alg": "ES256",
     "typ": "schema-attestation+sd-jwt"
   }

2.3.  Verifying Schema Attestation Documents

   Recipients of a Schema Attestation Document MUST verify the returned
   SD-JWT.

   Verification of the issuer of a Schema Attestation Document MUST
   follow current Best Practices for verifying JWT signatures.

2.3.1.  Verifying Issuers in authorized_issuers

   For an Issuer to be attested as Authorized to issue a Credential
   matching the respective Schema the value in the issuer claim of a
   [W3C.VCDM] Credential or the iss claim of a
   [I-D.ietf-oauth-sd-jwt-vc] Credential MUST be present in the
   authorized_issuers array.

2.3.2.  Verifying verifiers in authorized_verifiers

   For a verifier to be attested as Authorised to receive a Credential
   matching the respective Schema the value in the authorized_verifiers
   array MUST match one of the following:

   *  For an [OAUTH.OID4VP] presentation which presents the credential
      request as a request_uri JWT, the iss value MUST match the value
      in authorized_verifiers
   *  TODO: Identify other methods for identifying verifiers within a
      credential request

2.4.  Schema Extension

   [I-D.ietf-oauth-sd-jwt-vc] permits vct documents to extend from
   another vct document.  As a Schema Attestation Document attests for a
   specific version of a Schema document, the document the vct extends
   from MAY have its own attestation document.

   Schema Document Requests MUST NOT inherit Attestation from higher
   order Schema Attestation Documents.

3.  Security Considerations

3.1.  Issuer/Verifier Request for Information Discovery

   Requests to the well-known endpoint MAY use the issuer and verifier
   Request parameters in order to perform information discovery on the
   Disclosures within a the Attestation Document.

   Schema Attestation Document Providers SHOULD make effort to prevent
   Information Discovery utilizing methods such as Rate Limiting.

   Nonce values which are reused SHOULD be rejected if multiple requests
   from the same requester are received with the same nonce value.

3.2.  Schema Extension as a method for attaining a trusted status.

   An attacker MAY extend a known Schema document and provide their own
   Schema Attestation document in order to show themselves as 'verified'
   to Wallets and Verifiers.

   Whilst extension remains a valid method for building upon existing
   schema, Wallets SHOULD NOT treat extended documents as an attempt to
   bypass trust.  Wallets SHOULD show credentials with extended Schema
   as Trusted, so long as the issuer is correctly included as an
   authorized_issuers in the extended Schema's Schema Attestation
   Document.

   [OAUTH.OID4VP] includes the specification for Digital Credentials
   Query Language (DCQL).  DCQL introduces meta which allows for the
   specification of metadata associated with a Credential request.

   For [I-D.ietf-oauth-sd-jwt-vc] Credentials, the meta object MAY
   contain the vct_values key, which contains a non-empty array of
   strings.  A wallet MAY return Credentials that inherit from any type
   specified.  This means that imitation credentials MAY be provided and
   cannot be relied upon to filter imitation credentials.

   Verifiers SHOULD ensure that the Schema in use within a Verifiable
   Credential matches the expected Schema.

4.  References

4.1.  Normative References

   [I-D.ietf-oauth-sd-jwt-vc]
              Terbu, O., Fett, D., and B. Campbell, "SD-JWT-based
              Verifiable Credentials (SD-JWT VC)", Work in Progress,
              Internet-Draft, draft-ietf-oauth-sd-jwt-vc-13, 6 November
              2025, <https://datatracker.ietf.org/doc/html/draft-ietf-
              oauth-sd-jwt-vc-13>.

   [I-D.ietf-oauth-selective-disclosure-jwt]
              Fett, D., Yasuda, K., and B. Campbell, "Selective
              Disclosure for JWTs (SD-JWT)", Work in Progress, Internet-
              Draft, draft-ietf-oauth-selective-disclosure-jwt-22, 29
              May 2025, <https://datatracker.ietf.org/doc/html/draft-
              ietf-oauth-selective-disclosure-jwt-22>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC5785]  Nottingham, M. and E. Hammer-Lahav, "Defining Well-Known
              Uniform Resource Identifiers (URIs)", RFC 5785,
              DOI 10.17487/RFC5785, April 2010,
              <https://www.rfc-editor.org/info/rfc5785>.

   [W3C.SRI]  Akhawe, D., Braun, F., Marier, F., and J. Weinberger,
              "Subresource Integrity", 23 June 2016,
              <https://www.w3.org/TR/SRI/>.

4.2.  Informative References

   [IANA.well-known]
              IANA, "Well-Known URIs",
              <https://www.iana.org/assignments/well-known-uris>.

   [OAUTH.OID4VP]
              Terbu, O., Lodderstedt, T., Yasuda, K., Fett, D., and J.
              Heenan, "OpenID for Verifiable Presentations 1.0", 9 July
              2025, <https://openid.net/specs/openid-4-verifiable-
              presentations-1_0.html>.

   [W3C.DID]  Sporny, M., Longley, D., Sabadello, M., Reed, D., Steele,
              O., and C. Allen, "Decentralized Identifiers (DIDs) v1.0",
              19 July 2022, <https://www.w3.org/TR/did-1.0/>.

   [W3C.VCDM] Sporny, M., Longley, D., Chadwick, D., and O. Steele,
              "Verifiable Credentials Data Model v2.0", 10 February
              2024, <https://www.w3.org/TR/vc-data-model-2.0/>.

Appendix A.  IANA Considerations

A.1.  JSON Web Token Claims Registration

   *  Claim Name: "sub#integrity"

   *  Claim Description: JWT VC sub claim "integrity metadata" value

   *  Change Controller: IETF

   *  Specification Document(s): [[ Section 2.1.1 of this specification
      ]]

   *  Claim Name: "authorized_issuers"

   *  Claim Description: Authorized Issuers for a specific VC Schema

   *  Change Controller: IETF

   *  Specification Document(s): [[ Section 2.1.1 of this specification
      ]]

   *  Claim Name: "authorized_verifiers"

   *  Claim Description: Authorized Verifiers for a specific VC Schema

   *  Change Controller: IETF

   *  Specification Document(s): [[ Section 2.1.1 of this specification
      ]]

A.2.  Well-Known URI Registry

   This specification requests the well-known URI defined in
   Section 2.1.2 in the IANA "Well-Known URIs" registry
   [IANA.well-known] established by [RFC5785].

Appendix B.  Acknowledgements

   There are no acknowledgements at this time.

Appendix C.  Document History

   -00

   *  Initial Document

Author's Address

   Annabelle Kennedy
   Email: queekusme@gmail.com
